 <!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üìò PORTFOLIO KESIAPAN MASA DEPAN + LEMBAR KERJA</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', system-ui, sans-serif;
        }

        body {
            background: linear-gradient(145deg, #eef2f9 0%, #dfe8f3 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .app-container {
            max-width: 1100px;
            margin: 0 auto;
            background: rgba(255,255,255,0.9);
            backdrop-filter: blur(16px);
            border-radius: 48px;
            padding: 30px;
            box-shadow: 0 40px 80px -25px #142d47;
        }

        /* ===== FORM SISWA ===== */
        .siswa-form {
            background: white;
            border-radius: 40px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 10px 25px -10px #1f3b5c;
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            align-items: flex-end;
        }

        .form-group {
            flex: 1 1 200px;
        }

        .form-group label {
            display: block;
            font-weight: 600;
            color: #1f3b5c;
            margin-bottom: 8px;
        }

        .form-group select, .form-group input {
            width: 100%;
            padding: 12px 20px;
            border-radius: 30px;
            border: 2px solid #d4e2f5;
            font-size: 1rem;
            background: white;
        }

        .btn-primary {
            background: #1f3b5c;
            color: white;
            border: none;
            padding: 12px 35px;
            border-radius: 30px;
            font-weight: 600;
            cursor: pointer;
            font-size: 1rem;
            border: 1px solid white;
        }

        .btn-primary:hover {
            background: #143150;
        }

        /* tab navigasi */
        .tab-header {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .tab-btn {
            background: white;
            border: 2px solid #d2e1f5;
            padding: 15px 35px;
            border-radius: 60px;
            font-weight: 700;
            font-size: 1.2rem;
            color: #1f3b5c;
            cursor: pointer;
            transition: all 0.2s;
        }

        .tab-btn.active {
            background: #1f3b5c;
            border-color: #1f3b5c;
            color: white;
        }

        .tab-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* ===== KUIS SECTION ===== */
        .nav-numbers {
            background: white;
            border-radius: 40px;
            padding: 20px;
            margin-bottom: 25px;
        }

        .legend {
            display: flex;
            gap: 25px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .dot-green { width: 20px; height: 20px; background: #2ecc71; border-radius: 20px; box-shadow: 0 0 0 3px #d5f5e0; }
        .dot-red { width: 20px; height: 20px; background: #e74c3c; border-radius: 20px; box-shadow: 0 0 0 3px #fadbd8; }
        .dot-blue { width: 20px; height: 20px; background: #1f3b5c; border-radius: 20px; box-shadow: 0 0 0 3px #bfd9ff; }

        .angka-grid {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
        }

        .num-btn {
            width: 48px;
            height: 48px;
            border-radius: 48px;
            border: 2px solid;
            font-weight: 700;
            font-size: 1.1rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: 0.15s;
        }

        .num-btn.completed {
            background: #2ecc71;
            border-color: #2ecc71;
            color: white;
        }

        .num-btn.active {
            border-color: #1f3b5c;
            background: #1f3b5c;
            color: white;
            transform: scale(1.1);
        }

        .num-btn:not(.completed) {
            background: white;
            color: #e74c3c;
            border-color: #e74c3c;
        }

        .slide-card {
            background: white;
            border-radius: 36px;
            padding: 30px;
            margin: 25px 0;
        }

        .domain-tag {
            background: #1f3b5c;
            color: white;
            padding: 8px 25px;
            border-radius: 60px;
            display: inline-block;
            font-weight: 600;
            margin-bottom: 20px;
        }

        .soal-text {
            font-size: 1.6rem;
            font-weight: 700;
            color: #142d47;
            margin-bottom: 30px;
        }

        .opsi-item {
            display: flex;
            align-items: center;
            gap: 20px;
            background: #f5faff;
            border-radius: 60px;
            padding: 15px 25px;
            margin-bottom: 12px;
            border: 2px solid #d4e2f5;
            cursor: pointer;
        }

        .opsi-item.selected {
            border-color: #2ecc71;
            background: #e3f7e9;
        }

        .opsi-item input[type="radio"] {
            width: 24px;
            height: 24px;
            accent-color: #2ecc71;
        }

        .nav-buttons {
            display: flex;
            gap: 15px;
            margin-top: 25px;
        }

        .nav-btn, .hasil-btn {
            padding: 15px 30px;
            border-radius: 60px;
            font-weight: 600;
            font-size: 1.1rem;
            border: none;
            cursor: pointer;
        }

        .nav-btn {
            background: white;
            border: 2px solid #c7daf5;
            color: #1f3b5c;
            flex: 1;
        }

        .nav-btn:hover:not(:disabled) {
            background: #1f3b5c;
            color: white;
        }

        .nav-btn:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }

        .hasil-btn {
            background: #1f3b5c;
            color: white;
            padding: 15px 40px;
            font-weight: 700;
            flex: 0.8;
        }

        /* ===== HASIL ===== */
        .hasil-card {
            background: white;
            border-radius: 40px;
            padding: 30px;
        }

        .progress-domain {
            margin: 20px 0;
        }

        .progress-bar-bg {
            background: #e5effa;
            height: 20px;
            border-radius: 30px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            border-radius: 30px;
            transition: width 0.5s;
        }

        .rekom-card {
            background: #f0f9ff;
            border-radius: 30px;
            padding: 25px;
            margin: 25px 0;
            border-left: 12px solid;
        }

        .rekom-tinggi { border-color: #2ecc71; background: #e1f7e8; }
        .rekom-sedang { border-color: #f39c12; background: #fff1db; }
        .rekom-rendah { border-color: #e74c3c; background: #ffe9e6; }

        /* ===== LEMBAR KERJA ===== */
        .worksheet-section {
            background: #fcf9f0;
            border-radius: 40px;
            padding: 40px;
            border: 2px dashed #b3a97c;
            background-image: linear-gradient(#f3efdf 1px, transparent 1px);
            background-size: 100% 40px;
            font-family: 'Courier New', monospace;
        }

        .paper-header {
            text-align: center;
            margin-bottom: 40px;
            border-bottom: 3px solid #9b8c5c;
            padding-bottom: 20px;
        }

        .worksheet-item {
            margin-bottom: 35px;
            page-break-inside: avoid;
        }

        .worksheet-item h3 {
            font-size: 1.6rem;
            color: #4a3b24;
            border-left: 10px solid #a58c54;
            padding-left: 20px;
            margin-bottom: 20px;
        }

        .text-area-titik {
            width: 100%;
            border: none;
            border-bottom: 2px dotted #9b8c5c;
            background: transparent;
            font-size: 1.1rem;
            padding: 10px 0;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
            resize: vertical;
            min-height: 60px;
        }

        .text-area-titik:focus {
            outline: none;
            border-bottom: 2px solid #a58c54;
            background: #fffdf5;
        }

        .checkbox-grid {
            display: flex;
            flex-wrap: wrap;
            gap: 30px;
            margin: 20px 0;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .btn-download, .btn-simpan {
            background: #4a3b24;
            color: #fcf9f0;
            border: none;
            padding: 15px 30px;
            border-radius: 60px;
            font-size: 1.2rem;
            font-weight: 600;
            cursor: pointer;
            margin: 20px 10px 20px 0;
            border: 2px solid #fcf9f0;
        }

        .btn-simpan {
            background: #1f3b5c;
        }

        .btn-cetak {
            background: #27ae60;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 60px;
            font-size: 1.2rem;
            font-weight: 600;
            cursor: pointer;
            margin: 20px 0;
        }

        .hidden {
            display: none;
        }

        .status-simpan {
            padding: 15px;
            border-radius: 30px;
            margin: 20px 0;
            font-weight: 600;
        }

        .sukses { background: #d5f5e0; color: #0b5e2e; }
        .error { background: #fadbd8; color: #943126; }
    </style>
</head>
<body>

<div class="app-container">
    <!-- FORM PILIH SISWA -->
    <div class="siswa-form" id="formSiswa">
        <div class="form-group">
            <label>Pilih Kelas</label>
            <select id="pilihKelas" onchange="filterNama()">
                <option value="">-- Pilih Kelas --</option>
                <option value="XII-1">XII-1</option>
                <option value="XII-2">XII-2</option>
                <option value="XII-3">XII-3</option>
                <option value="XII-4">XII-4</option>
                <option value="XII-5">XII-5</option>
                <option value="XII-6">XII-6</option>
                <option value="XII-7">XII-7</option>
                <option value="XII-8">XII-8</option>
                <option value="XII-9">XII-9</option>
            </select>
        </div>
        <div class="form-group">
            <label>Pilih Nama</label>
            <select id="pilihNama">
                <option value="">-- Pilih Nama --</option>
            </select>
        </div>
        <button class="btn-primary" onclick="mulaiKuis()">Mulai Kuis</button>
    </div>

    <!-- Tab Navigator -->
    <div class="tab-header">
        <button class="tab-btn active" data-tab="quiz" id="tabQuizBtn">üìù Kuis Kesiapan</button>
        <button class="tab-btn" data-tab="hasil" id="tabHasilBtn" disabled>üìä Hasil & Tindak Lanjut</button>
        <button class="tab-btn" data-tab="worksheet" id="tabWorksheetBtn" disabled>üìÑ Lembar Kerja</button>
    </div>

    <!-- ===== TAB 1: KUIS ===== -->
    <div id="tab-quiz" class="tab-content active">
        <div class="nav-numbers">
            <div class="legend">
                <span class="legend-item"><span class="dot-green"></span> sudah dijawab</span>
                <span class="legend-item"><span class="dot-red"></span> belum dijawab</span>
                <span class="legend-item"><span class="dot-blue"></span> sedang aktif</span>
            </div>
            <div class="angka-grid" id="gridAngka"></div>
        </div>

        <div id="slideSoal"></div>

        <div class="nav-buttons">
            <button class="nav-btn" id="prevSoal" disabled>‚Üê Sebelumnya</button>
            <button class="nav-btn" id="nextSoal">Selanjutnya ‚Üí</button>
            <button class="hasil-btn" id="lihatHasilBtn">üîç Lihat Hasil & Rencana</button>
        </div>
    </div>

    <!-- ===== TAB 2: HASIL & TINDAK LANJUT ===== -->
    <div id="tab-hasil" class="tab-content">
        <div id="hasilContainer"></div>
    </div>

    <!-- ===== TAB 3: LEMBAR KERJA ===== -->
    <div id="tab-worksheet" class="tab-content">
        <div id="worksheetContainer"></div>
    </div>
</div>

<!-- Status Message -->
<div id="statusMessage" class="hidden"></div>

<script>
// ===================== DATA SISWA =====================
const dataSiswa = {
    "XII-1": "A. AUFA ASLAM ANJABI|AISYAH RAHMA AULIA|ANISA MAULIDYA HASANAH|ARINA MANASIKANA|ARUM NOOR SETIANY|DEWI WINDYAWATI|DIAH ANGGRAINI|DZU AISY YESAWA AUFA JULETHA|EKI NURWIDIASTUTI|EMHA HASANAIN MAHLUF AQMA|FADZILLAH AINITHA RAHMAN|HAMZAH AQIL AL MUSTAFA|ICHA SEPTIANA WULANDARI|LAELI MUNA|LAYLA SYARIFA RAHMADHANI|LINTANG APRILLIYANI|MADINA RAMADHANI|MARSYA NUR MAULIDINA|MAULIDA MAHARANI|MAZIDA RIFQI AFFANI|MUHAMMAD AHNAF SYAIBAN|MUHAMMAD DESTA ARIYANSYAH|MUHAMMAD RIZYK ABDILLAH|MUHAMMAD SYAUQY MUSTHOFA|NAILA PUTRI AFIFAH|NAJWA BALQIS SYAFIRA|NAURAH LAELATUL FAHRIYAH|NUR RAISYA RAHMADANI|OLIVIA RISKA RAMANDHANI|QURROTU AINII PUTRI HARTUTI|RACHEL AZEERA MARSYA PUTRI|SAMDYA FADLIKA|WULAN WIDYA AYU PRATIWI|ZAHARA BUNGA KAMELIA|ZIZNI RIZKI ADITIYA|ZULFATURROHMAH AZZAHRA".split('|'),
    "XII-2": "AGESTA FADILAH ADAM|ARYA MAHENDRA RYANSYAH NOOR|AULIA PUSPA LESTARI|AULIA ZAIDATUSSALWA|CAHYO HADI LAKSONO|CHESYLLA AZ-ZAHRA WIDYANDA|DESTA AMELIA|FARAH NAILA AMANI|FEBRIANA RIZKY NURSANDI|GITA CITRA CINTA|IKRIMAH SYADIDA|IMANIA SALMA FARIZAH|JIBRIL ASYKAR CHABIBILLAH|KHASNA SALSABILA|KUSUMA AMMARY KHOIRUNNISA|M. RIKI IMAMUDDIN|MALIKHA MAHRASSALISA|MOCHAMAD FACHRI|MOH FAYRUZ SYAF TAFTAZANI|MUHAMAD KHOIRUL ANAM|MUHAMMAD DANY ROKAN|MUHAMMAD HISYAM AKMAL|MUHAMMAD NABIL DZAKIY|MUHAMMAD RIO FABIAN|NABILATUL KHASANAH|OCTAVIA RAMADHANI|RATNA MAULIDAH KHASANAH|RISMA DUMA FITRI|RIZQIATUL AZZAHRA|SALMA DIAN SAFIRA|SAYLA ARZAQINA|SINDIA KIRAN MUSTIKA|UMI LIFGIATUN RAMDANI|VITARI AZIZAH|WINDI SILVIANA|ZAHRAKHAN FARABI".split('|'),
    "XII-3": "ACHMAD RIZQI ABIANSYAH|AISYAH KUSUMANINGSIH|AISYATUN NISAFITRI|AMALIA FARIDA AININ WIBOWO|ANINDYA QUTROTUNNANDA|ANITA PUTRI PRADHITA|AZZAHRA NUR MUFIDA|DHIKA BINTANG PRATAMA|FATIHATUL ZATIN AGAINI|FEBRINA SUKMA TYASSHOFA|FEBRYANA EIVANOVICH|HAMIM FAIQ BUDIMAN|HANA DHIA KARIMAH|INKAFALAH SATYATUHU NIATRIA|KHUSNA AQILA ROSYADA|M.  AFIQ NABIL ILMI|MAELA ZULFAA|MUHAMMAD FIKRI NAZHIF|MUHAMMAD NUR KHOLIS|MUHAMMAD RAFFI FARIZQI|MUHAMMAD ROYYAN HUDAYANTO|NAOFAL SANTOSO|NAYLA ZAHRATU ATHA|NUR SYIFA RAMADHINA|PUTRA PRIMA NUGRAHA|RIBKA RIZKI ZAHRANI|SALSA OKTA AMELIA|SHAFIA DAVISYA KHOLIQ|SHERLINA KHAERANI|SURYA AJI JANUARTA|TIARA SEPTY RAMADHANI|TRI PERTIWI HANDAYANI|WAHYU RAHARDIAN ARSANATA|YODHANO ALBERN HAIDAR SUSANTO|ZAKY ANWAR|ZIDNI ILMAN NAAFI'AN".split('|'),
    "XII-4": "ALEARAFA ZADA HUKAMA|ARGA PRANADYA NASUTION|ARKAN ARI ANANTO|AULIA ZAMZAMAH|CEISYA SILVI SALSABILLA|DEVA ADITYA NUGROHO|FIRDA AULIA IZZATI|GILANG ADI WIRATAMA|HAIDAR HUSAIN PRADITA|HISYAAM DZAKY MUBAROK|ISTIQOMAH|KHURIDAH KHASANAH|M. IKHSANUDDIN LATIF|M. ZAKY KENNEDY SAPUTRA|MARSYA ELLEN FATMIKA|MAULANA NIBAS|MUCH. AUFAR ABID|MUHAMMAD ARDIANSYAH ARYA PUTRA PRATAMA|MUHAMMAD HYZAM KURNIAWAN|MUHAMMAD KHAIDAR MAULANA|MUHAMMAD RAIFAN KHALED|MUHAMMAD REYHAN ADAKY|MUHAMMAD SHAVO SATRIANI|NADYA PUTRI RAMADHANI|NASRUL KHOLBI|NATASYA AZKA HINDRIANA|NISWA MAZILA FIJANA|NURUL ISLAMIYATI|PRICO ANDRIANO|SEVILA ARDHIA ROHMA|SHERLY ARDIANTI SUKMA|SUN CANDHA RENDY SULAIMAN|SYIFA JULIA MAULA|VITA AZZARIA|ZAHRA SEPTI RAMADHANI".split('|'),
    "XII-5": "ADINDA AINUN MAHYA|ADINDA NURAINI|ADINDA ZHAFIRAH HELMAPUTRI|AFIFTIAN RASYA MAULANA|BILQIS RAMADHANI DJUNAEDY PUTRI|CHELSEA KHATYA AZ ZAHRA|DAFFA AUFA NASWA|DHANURWENDHA ILHAMRAKA SASKARA|EZAR HAFIZH DWIPANDYA|FIANTIKA AULIA ZIVANESTHA|GANESHA ARDIANEDRIA HERBIMO|HANIIF RAMDHAN SYARIIF|HARYA TIRTA SANTOSO|HAYUNING TYAS KUSUMARDANI|JASMINE YUMN MUMTAZ|LUTFI FARHAN ADITYA|MELLYSA AZLYA SALLYMA|MUHAMMAD AL GHIFARI|MUHAMMAD DIMAS DWI ANDREAN|MUHAMMAD FIRMAN GHADAFFI|MUHAMMAD IBNU ABDI SALAM|MUHAMMAD LUTHFI MAHARDIKA|MUHAMMAD SHALAHUDDIN|MUHAMMAD SURYA NUGRAHA|NADIA SHARLIZ RAIHANA|NADINE DAMARA RAFA|NAURA JANNAH|NAURA MAZIIDATUL KHAIRA|NISRINA ARIFIN|NURUL ISNI ALDILA|PRATAMA EMIR MAULIDA|RIFKI ALWI HIDAYAT|SANGGA ADYA SETYAGITA|WIDYA MUFLIHATUN NISA|YASMIN KAMILA|ZAIDAAN GHATHFAN NAAFI".split('|'),
    "XII-6": "AHMAD NADA AL-AFGANI|ALIN IHSAN|AMELA ASIFA CINTA SALSA BILLA|ANDIKA ELVAN ZANI|ARADJA ADIGWAN|AZEL DANISWARA|BELLA OKTALIDYA PUTRI|CLAUDIA ALFRI YANTI|DIBENZAQI|DINDA DWI LASITA|ELSA INDRILASARI|FRISKA ASKINADIA|ISNU PRAMUSINTHO|LULUK AINI NAFISAH|M. DHANNIES FEBRIANO|M. ZAFQI ALIEF UZZAMAN|MUHAMMAD AGHIS MUSTAGHIS|MUHAMMAD ALWAN FAKHRI|MUHAMMAD FAREL|MUHAMMAD FATWA ADITYA|MUHAMMAD GUNTUR ALFA RIZQY|MUHAMMAD RIZQI JANWAR|MUHAMMAD UBAIDILLAH|NAYAKA ADWITIYA FATHONY|NUR ISROATUL ULA|PRISKA GAVRILA RIYADI|PUTRA CAHYA RAMADHAN|RACHEL SETYA UTAMA|RAKHA SYAFIQ AN NAJIB|RAVENO ANDREAN MEVALDI|ZAHIRA NUR KHASANAH|ZAKI ALMAS MUSYAFA".split('|'),
    "XII-7": "ADINDA ANATASYA STEVANIE|AISYA NISRINA PUTRI|ALFINDO SURYA SATRIAGUNG|ANUGRAHENING HERSYA NOVIA WIJAYA|AULIA JANATU SIEVA|AURA ZAHRA|AYUN SHINTA FEBRIANI MAZIYAH|CAHYA AYU ANGGITA|CHAYLA MARZA DIANOVA|DESI RAKHMAWATI|DINI LISTIANA|FANY FALASIFA|GHINA SYAKIRAH IHSAN|HANDIS EL FAIQOH|HAYYA WAHIDATUN NASWA|IMALIKHA FATYA KURNIALLAH|IVAN TRIANSYAH|KINARD FIAN MAHARANI|LAILATUL HABIBAH|MAUREL ZASKYA ZAKY|MOCHAMMAD ERRIN PANCA RIZKI|MUHAMMAD HILMY NABIHA|NIBRAS AISYAH ANINDITAWIJAYA|NOVA AULIA BERLIANI|RIZA DAMAYANTI|SAFFANATU IHTAZANA|SEKAR SARI|SELVI IBFAQOTUL WAFA|SHETI ALTHAFI RANTI|SYAFIRA MAULIDATUR RISQI|TSABHITA AURELYA SAFA KARISA|UMI DZINNU ROINI|VANIA KRISTIANINGRUM|YESINA SALWA AURELIA|ZARA FIRJATUL HUSNA|ZHAFRAN ARVA NAUFALINO".split('|'),
    "XII-8": "AHMAD IQBAL MAULANA|ARSYA SAFIRA|ASYIFA DWI AMELIA|AULIA ANURRIZA|AZARIA CALLISTA|BUNGA FINA DWI YANTI|CANTIKA SEPTIANI RAMADHANI|DIAN AYU AGUSTINA|DINA MELISA|ENDITO CAHYA PRATAMA|GUIDO GANANG SAPUTRA|HAFIDZ MUHAMAD NOVIAN|JAZILA NAFAANI ISNADA|KEISYA REVALINA|KRIS TRIANTO RAMADHANI|LABIDAH|LUKI SEBA LUKITO|M. IKROM MAULIDIN|MUHAMMAD MAKRUF|MUHAMMAD NAUFAL RIZQI|MUSLIKHA|NADIA RAMA|NAILA AMELINDA|NATASYA DEKA ALVISKA|NESYA HAFIZTA PUTRI|NONIQ AQUINI BALQIS|NUR KHOMSATUN KHASANAH|QONITA PUTRI ADIZA|RACHEL DESINTHA FANY|RAFIF EGA PRATAMA|RAISYA HANUM AGITA|SATRIA ABDUL MAJID|SYARIFAH NAADIYA MUHAIMIN|TIVANI NUR AULYA".split('|'),
    "XII-9": "AHMAD FAESOL AL MURSYIDI|ALINA CAHYA KARTIKA|ARDIAN AZMI LAZUARDI|ARISKA AMILIA|ATTIYATUL FAHIRA|AZMI ARFITA SARI|CAHAYA SEKAR AYU|CHATERINE ALIKA SAWITRI|DWI SAFITRI|ESHAL DELBAR DINAR|FADIA AZZAHRA SISYANA PUTTRI|GENDIES TALITHA ZAIN|HAMMAM NAYAKA ABIUDAYA|JUTIA RAMADANI|KHANZA AZ ZAHRA|KHOLIFATUS SYAHIRAH|KUS NAENI|MARSYA KHARINA NAZIFAH|MISKIYAH|MUHAMMAD KHILMI HAIDAR|MUNAH AININ WAFIQAH|NADIRA RIFDA ARSIANDANA|NAUVA ALMAS SHINA|NAYSILA MAULIDA AZKYA|NIZA BELLA PUTRI|PUTRI NINGSIH|RAHMA ZAHRATUSITA|RAHMAT HIDAYAH|RIKA DWI ARDIANTI|RISKIYA HASNA SAFIRAH|RISQINAFIATUL KHUSNA|RIZKA DWI AMELIA|SARAH REVALINA ACHMAD|SCHATZI NABILA SARI|SHINTA AULIA DEWI|SYAKILA KARIMA PRANOTO".split('|')
};

// ===================== DATA SOAL (30 SOAL) =====================
const soal30 = [
    "Saya yakin bisa bersaing di dunia kerja atau perkuliahan.",
    "Saya mampu menghadapi penolakan (lamaran ditolak / tidak diterima di PTN).",
    "Saya berani mengungkapkan pendapat dalam diskusi kelompok.",
    "Saya tidak mudah menyerah saat menghadapi kegagalan.",
    "Saya percaya diri saat wawancara atau presentasi.",
    "Saya mampu mengelola stres ketika tekanan datang.",
    "Saya terbiasa datang tepat waktu dalam setiap kegiatan.",
    "Saya mampu bekerja sama dalam tim dengan berbagai karakter orang.",
    "Saya aktif mencari informasi tentang karier atau kampus impian.",
    "Saya memiliki kebiasaan belajar atau mengasah skill secara rutin.",
    "Saya berani mengambil tanggung jawab lebih (organisasi/panitia).",
    "Saya bisa mengatur prioritas antara tugas, organisasi, dan istirahat.",
    "Saya sudah memiliki portofolio atau catatan prestasi (akademik/non).",
    "Saya mengenali minat dan bakat yang ingin saya kembangkan.",
    "Saya paham langkah-langkah melamar kerja atau mendaftar kuliah.",
    "Saya terbiasa membuat target jangka pendek dan mengevaluasinya.",
    "Saya mampu belajar hal baru secara mandiri (online/book).",
    "Saya memiliki kemampuan dasar komputer atau bahasa asing.",
    "Saya menjaga nama baik di media sosial.",
    "Saya mampu menerima kritik dan memperbaiki diri.",
    "Saya berani meminta maaf jika melakukan kesalahan.",
    "Saya menghormati atasan/dosen dan rekan.",
    "Saya bersikap profesional meskipun dalam situasi informal.",
    "Saya bertanggung jawab terhadap tugas yang diberikan.",
    "Saya sudah memiliki gambaran karier atau jurusan kuliah.",
    "Saya tahu cara membuat CV atau portofolio sederhana.",
    "Saya pernah mengikuti pelatihan / seminar pengembangan diri.",
    "Saya memiliki rencana cadangan jika rencana utama gagal.",
    "Saya mulai menabung atau merencanakan keuangan untuk masa depan.",
    "Saya memiliki mentor / role model yang bisa diajak diskusi."
];

const domain30 = {
    "üß† Mental Tangguh": [0,1,2,3,4,5],
    "üìã Perilaku & Kebiasaan": [6,7,8,9,10,11],
    "üìö Kesiapan Akademik": [12,13,14,15,16,17],
    "ü§ù Sikap & Etika": [18,19,20,21,22,23],
    "üéØ Perencanaan Masa Depan": [24,25,26,27,28,29]
};

const opsi = [
    "ü´£ tidak sesuai saya",
    "ü§î kadang-kadang",
    "üôÇ cukup sering",
    "üòå sering, hampir selalu",
    "üöÄ sangat sesuai, selalu"
];

// ===================== STATE APLIKASI =====================
let jawaban = new Array(30).fill(null);
let currentIndex = 0;
let selectedKelas = '';
let selectedNama = '';

// ===================== FILTER NAMA =====================
window.filterNama = function() {
    const kelas = document.getElementById('pilihKelas').value;
    const namaSelect = document.getElementById('pilihNama');
    namaSelect.innerHTML = '<option value="">-- Pilih Nama --</option>';
    
    if (kelas && dataSiswa[kelas]) {
        dataSiswa[kelas].forEach(nama => {
            if (nama.trim()) {
                const option = document.createElement('option');
                option.value = nama.trim();
                option.textContent = nama.trim();
                namaSelect.appendChild(option);
            }
        });
    }
};

// ===================== MULAI KUIS =====================
window.mulaiKuis = function() {
    selectedKelas = document.getElementById('pilihKelas').value;
    selectedNama = document.getElementById('pilihNama').value;
    
    if (!selectedKelas || !selectedNama) {
        alert('Pilih kelas dan nama terlebih dahulu!');
        return;
    }
    
    // Reset jawaban
    jawaban = new Array(30).fill(null);
    currentIndex = 0;
    
    // Enable tab hasil dan worksheet
    document.getElementById('tabHasilBtn').disabled = false;
    document.getElementById('tabWorksheetBtn').disabled = false;
    
    // Render ulang
    renderGrid();
    renderSlide();
    
    // Pindah ke tab kuis
    document.querySelector('[data-tab="quiz"]').click();
};

// ===================== RENDER GRID =====================
function renderGrid() {
    const gridAngka = document.getElementById('gridAngka');
    let html = '';
    for (let i = 0; i < 30; i++) {
        const completed = jawaban[i] !== null;
        const active = (i === currentIndex);
        let kelas = 'num-btn';
        if (completed) kelas += ' completed';
        if (active) kelas += ' active';
        html += `<button class="${kelas}" data-index="${i}">${i+1}</button>`;
    }
    gridAngka.innerHTML = html;

    document.querySelectorAll('.num-btn').forEach(btn => {
        btn.addEventListener('click', () => {
            const idx = parseInt(btn.dataset.index);
            if (!isNaN(idx)) {
                currentIndex = idx;
                renderSlide();
                renderGrid();
            }
        });
    });
}

// ===================== RENDER SLIDE =====================
function renderSlide() {
    const idx = currentIndex;
    let domain = '';
    for (let d in domain30) {
        if (domain30[d].includes(idx)) domain = d;
    }

    const selected = jawaban[idx];
    let html = `
        <div class="slide-card">
            <div class="domain-tag">${domain}</div>
            <div class="soal-text">${soal30[idx]}</div>
            <div class="opsi-container">
    `;

    opsi.forEach((opt, optIdx) => {
        const val = optIdx + 1;
        const selectedClass = (selected === val) ? 'selected' : '';
        html += `
            <div class="opsi-item ${selectedClass}" data-value="${val}">
                <input type="radio" name="radioSlide" value="${val}" id="opt_${idx}_${optIdx}" ${selected === val ? 'checked' : ''}>
                <label for="opt_${idx}_${optIdx}">${opt}</label>
            </div>
        `;
    });

    html += `</div></div>`;
    document.getElementById('slideSoal').innerHTML = html;

    // Event listener
    document.querySelectorAll('.opsi-item').forEach(item => {
        item.addEventListener('click', function() {
            const radio = this.querySelector('input[type="radio"]');
            if (radio) {
                radio.checked = true;
                radio.dispatchEvent(new Event('change', { bubbles: true }));
            }
        });
    });

    document.querySelectorAll('input[name="radioSlide"]').forEach(radio => {
        radio.addEventListener('change', (e) => {
            const val = parseInt(e.target.value);
            jawaban[currentIndex] = val;
            document.querySelectorAll('.opsi-item').forEach(opt => opt.classList.remove('selected'));
            e.target.closest('.opsi-item').classList.add('selected');
            renderGrid();
            updateNavButtons();
        });
    });

    updateNavButtons();
}

function updateNavButtons() {
    document.getElementById('prevSoal').disabled = (currentIndex === 0);
    document.getElementById('nextSoal').disabled = (currentIndex === 29);
}

// ===================== NAVIGASI =====================
document.getElementById('prevSoal').addEventListener('click', () => {
    if (currentIndex > 0) {
        currentIndex--;
        renderSlide();
        renderGrid();
    }
});

document.getElementById('nextSoal').addEventListener('click', () => {
    if (currentIndex < 29) {
        currentIndex++;
        renderSlide();
        renderGrid();
    }
});

// ===================== TAB NAVIGATION =====================
document.querySelectorAll('.tab-btn').forEach(btn => {
    btn.addEventListener('click', () => {
        const tab = btn.dataset.tab;
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
        btn.classList.add('active');
        document.getElementById(`tab-${tab}`).classList.add('active');
    });
});

// ===================== HITUNG HASIL =====================
document.getElementById('lihatHasilBtn').addEventListener('click', () => {
    const belum = jawaban.reduce((acc, val, idx) => val === null ? acc.concat(idx+1) : acc, []);
    if (belum.length > 0) {
        alert(`Masih ada ${belum.length} soal belum dijawab: nomor ${belum.join(', ')}`);
        return;
    }

    let skorDomain = {};
    let total = 0;
    for (let d in domain30) {
        skorDomain[d] = 0;
        domain30[d].forEach(i => skorDomain[d] += jawaban[i]);
        total += skorDomain[d];
    }

    const persen = (total / 150) * 100;

    let profil, warnaRekom, rekomendasi, tindakLanjut;
    if (persen >= 80) {
        profil = "üî• SANGAT SIAP";
        warnaRekom = "rekom-tinggi";
        rekomendasi = "Kesiapan mental dan perilaku kamu sangat baik untuk menghadapi masa depan.";
        tindakLanjut = "‚û°Ô∏è Mulai bangun portofolio nyata, cari magang, asah skill wawancara, perluas jaringan.";
    } else if (persen >= 60) {
        profil = "üå± CUKUP SIAP";
        warnaRekom = "rekom-sedang";
        rekomendasi = "Kamu sudah punya fondasi, tapi masih perlu penguatan.";
        tindakLanjut = "‚û°Ô∏è Fokus pada domain dengan skor terendah. Ikut pelatihan soft skill, cari mentor.";
    } else {
        profil = "ü´Ç BUTUH PERSIAPAN INTENSIF";
        warnaRekom = "rekom-rendah";
        rekomendasi = "Kamu masih butuh banyak persiapan, tapi ini bisa dilatih.";
        tindakLanjut = "‚û°Ô∏è Mulai dari hal kecil: rutinitas belajar, gabung komunitas, konsultasi dengan guru BK, buat target mingguan.";
    }

    // Tampilkan hasil
    let html = `
        <div class="hasil-card">
            <h2 style="font-size:2rem; margin-bottom:30px;">üìä Hasil Analisis Kesiapan</h2>
            <p><strong>Nama:</strong> ${selectedNama} | <strong>Kelas:</strong> ${selectedKelas}</p>
    `;

    for (let d in skorDomain) {
        const skor = skorDomain[d];
        const persenDomain = (skor / 30) * 100;
        let warna = persenDomain >= 70 ? '#2ecc71' : (persenDomain >= 50 ? '#f39c12' : '#e74c3c');
        html += `
            <div class="progress-domain">
                <div style="display:flex; justify-content:space-between;">
                    <span>${d}</span>
                    <span>${skor}/30</span>
                </div>
                <div class="progress-bar-bg">
                    <div class="progress-fill" style="width:${persenDomain}%; background:${warna};"></div>
                </div>
            </div>
        `;
    }

    html += `
        <div style="font-size:2rem; text-align:center; margin:40px 0 20px;">
            ‚ú® Total: ${total}/150 (${Math.round(persen)}%)
        </div>
        <div class="rekom-card ${warnaRekom}">
            <h3 style="font-size:1.8rem;">${profil}</h3>
            <p style="margin:15px 0;">${rekomendasi}</p>
            <div style="background:white; padding:20px; border-radius:20px;">
                <strong>üìã Tindak Lanjut:</strong>
                <p style="margin-top:10px;">${tindakLanjut}</p>
            </div>
        </div>
    `;

    document.getElementById('hasilContainer').innerHTML = html;
    
    // Generate worksheet
    generateWorksheet(skorDomain, total, persen, profil);
    
    // Pindah ke tab hasil
    document.querySelector('[data-tab="hasil"]').click();
});

// ===================== GENERATE WORKSHEET =====================
function generateWorksheet(skorDomain, total, persen, profil) {
    const sortedDomains = Object.entries(skorDomain).sort((a,b) => a[1] - b[1]);
    const top3Lemah = sortedDomains.slice(0, 3);

    let html = `
        <div class="worksheet-section">
            <div class="paper-header">
                <h2>üìú LEMBAR KERJA PERSIAPAN MASA DEPAN</h2>
                <p style="font-size:1.2rem;">Nama: <strong>${selectedNama}</strong> | Kelas: <strong>${selectedKelas}</strong> | Tanggal: <strong>${new Date().toLocaleDateString('id-ID')}</strong></p>
            </div>

            <div class="worksheet-item">
                <h3>üìå RINGKASAN HASIL KUIS</h3>
                <p><strong>Total Skor:</strong> ${total}/150 (${Math.round(persen)}%) ‚Äî ${profil}</p>
                <p><strong>3 Area Prioritas Penguatan:</strong></p>
                <ol>
                    ${top3Lemah.map(([d, s]) => `<li>${d} (${s}/30)</li>`).join('')}
                </ol>
            </div>

            <div class="worksheet-item">
                <h3>üìÖ RENCANA AKSI 30 HARI</h3>
                <p>Tuliskan target konkret yang akan kamu lakukan dalam 30 hari ke depan:</p>
                <textarea class="text-area-titik" placeholder="Contoh: Minggu 1: Mencari informasi kampus. Minggu 2: Membuat CV..."></textarea>
                <textarea class="text-area-titik" placeholder="Target berikutnya..."></textarea>
                <textarea class="text-area-titik" placeholder="Target berikutnya..."></textarea>
            </div>

            <div class="worksheet-item">
                <h3>‚úÖ CEKLIS KEBIASAAN HARIAN</h3>
                <p>Beri tanda (‚úî) setiap hari jika melakukan:</p>
                <div class="checkbox-grid">
                    <div class="checkbox-item"><input type="checkbox"> Bangun pagi ‚â§ jam 5.30</div>
                    <div class="checkbox-item"><input type="checkbox"> Baca artikel pengembangan diri (15 menit)</div>
                    <div class="checkbox-item"><input type="checkbox"> Latihan public speaking</div>
                    <div class="checkbox-item"><input type="checkbox"> Menulis jurnal harian</div>
                    <div class="checkbox-item"><input type="checkbox"> Olahraga/meditasi</div>
                    <div class="checkbox-item"><input type="checkbox"> Belajar skill baru (30 menit)</div>
                </div>
            </div>

            <div class="worksheet-item">
                <h3>üìù RENCANA MENTORING</h3>
                <p>Siapa yang bisa menjadi mentor atau teman diskusimu?</p>
                <textarea class="text-area-titik" placeholder="Contoh: Guru BK, Kakak kelas, alumni..."></textarea>
                <p>Apa yang ingin kamu diskusikan?</p>
                <textarea class="text-area-titik" placeholder="Contoh: Cara memilih jurusan, strategi belajar..."></textarea>
            </div>

            <div class="worksheet-item">
                <h3>üí° IDE KONEKSI DUNIA NYATA</h3>
                <p>Cari 3 peluang: magang, kunjungan industri, atau kelas praktisi</p>
                <textarea class="text-area-titik" placeholder="1. ..."></textarea>
                <textarea class="text-area-titik" placeholder="2. ..."></textarea>
                <textarea class="text-area-titik" placeholder="3. ..."></textarea>
            </div>

            <div style="display:flex; gap:10px; justify-content:center; margin-top:40px;">
                <button class="btn-simpan" onclick="simpanWorksheet()">üíæ SIMPAN KE DATABASE</button>
                <button class="btn-cetak" onclick="cetakWorksheet()">üñ®Ô∏è CETAK LEMBAR KERJA</button>
            </div>
        </div>
    `;

    document.getElementById('worksheetContainer').innerHTML = html;
}

// ===================== SIMPAN KE GOOGLE SHEET =====================
// ===================== SIMPAN KE GOOGLE SHEET =====================
window.simpanWorksheet = async function() {
    try {
        // Tampilkan status loading
        const status = document.getElementById('statusMessage');
        status.className = 'status-simpan';
        status.textContent = '‚è≥ Menyimpan data...';
        status.classList.remove('hidden');
        
        // Ambil data dari textarea
        const textareas = document.querySelectorAll('#worksheetContainer .text-area-titik');
        const checkboxes = document.querySelectorAll('#worksheetContainer input[type="checkbox"]:checked');
        
        // Ambil skor dari hasil kuis (dari localStorage atau hitung ulang)
        const totalSkor = localStorage.getItem('totalSkor') || '';
        const profil = localStorage.getItem('profil') || '';
        
        // Format kebiasaan
        const kebiasaanList = [];
        document.querySelectorAll('#worksheetContainer .checkbox-item').forEach((item, index) => {
            const cb = item.querySelector('input[type="checkbox"]');
            const label = item.textContent.trim();
            if (cb && cb.checked) {
                kebiasaanList.push(label);
            }
        });
        
        // Data yang akan dikirim
        const data = {
            kelas: selectedKelas,
            nama: selectedNama,
            rencana1: textareas[0]?.value || '',
            rencana2: textareas[1]?.value || '',
            rencana3: textareas[2]?.value || '',
            mentor1: textareas[3]?.value || '',
            mentor2: textareas[4]?.value || '',
            ide1: textareas[5]?.value || '',
            ide2: textareas[6]?.value || '',
            ide3: textareas[7]?.value || '',
            kebiasaan: kebiasaanList.join('; '),
            totalSkor: totalSkor,
            profil: profil
        };
        
        console.log('Data yang dikirim:', data);
        
        // GANTI URL INI DENGAN URL WEB APP ANDA
        const scriptURL = 'https://script.google.com/a/macros/guru.sma.belajar.id/s/AKfycby7pi2rUGgBfh9njaowl-l2sjxm0Eliwv5gmTzr8ya3uuy0-fgyeMUkDrLsEq2PyBkZwA/exec';
        
        // Kirim data dengan mode no-cors (untuk menghindari CORS)
        const response = await fetch(scriptURL, {
            method: 'POST',
            mode: 'no-cors', // Penting: no-cors untuk Google Apps Script
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(data)
        });
        
        // Dengan mode no-cors, kita tidak bisa membaca response
        // Tapi kita tahu request sudah terkirim
        
        status.className = 'status-simpan sukses';
        status.textContent = '‚úÖ Data berhasil dikirim ke Google Sheet!';
        
        // Simpan juga ke localStorage sebagai backup
        const savedData = JSON.parse(localStorage.getItem('kuisData') || '[]');
        savedData.push({
            timestamp: new Date().toISOString(),
            ...data
        });
        localStorage.setItem('kuisData', JSON.stringify(savedData));
        
        setTimeout(() => status.classList.add('hidden'), 5000);
        
    } catch (error) {
        console.error('Error detail:', error);
        
        const status = document.getElementById('statusMessage');
        status.className = 'status-simpan error';
        status.textContent = '‚ùå Gagal menyimpan. Tapi data tersimpan di lokal.';
        status.classList.remove('hidden');
        
        // Backup ke localStorage
        try {
            const textareas = document.querySelectorAll('#worksheetContainer .text-area-titik');
            const backupData = {
                timestamp: new Date().toISOString(),
                kelas: selectedKelas,
                nama: selectedNama,
                rencana1: textareas[0]?.value || '',
                rencana2: textareas[1]?.value || '',
                rencana3: textareas[2]?.value || '',
            };
            const savedData = JSON.parse(localStorage.getItem('kuisDataBackup') || '[]');
            savedData.push(backupData);
            localStorage.setItem('kuisDataBackup', JSON.stringify(savedData));
        } catch (e) {}
        
        setTimeout(() => status.classList.add('hidden'), 5000);
    }
};

// Tambahkan fungsi untuk menyimpan skor ke localStorage saat lihat hasil
document.getElementById('lihatHasilBtn').addEventListener('click', function() {
    // ... kode yang sudah ada ...
    
    // Tambahkan ini di bagian akhir setelah menghitung skor
    localStorage.setItem('totalSkor', total);
    localStorage.setItem('profil', profil);
    
    // ... lanjutkan kode ...
});

// ===================== CETAK WORKSHEET =====================
window.cetakWorksheet = function() {
    const content = document.getElementById('worksheetContainer').innerHTML;
    const printWindow = window.open('', '_blank');
    printWindow.document.write(`
        <html>
            <head>
                <title>Lembar Kerja - ${selectedNama}</title>
                <style>
                    body { font-family: 'Courier New', monospace; padding: 40px; background: #fcf9f0; }
                    .worksheet-section { max-width: 800px; margin: 0 auto; }
                    .text-area-titik { border: none; border-bottom: 2px dotted #9b8c5c; width: 100%; min-height: 40px; background: transparent; }
                    ${document.querySelector('style').innerHTML}
                </style>
            </head>
            <body>
                <div class="worksheet-section">
                    ${content.replace('<button class="btn-simpan" onclick="simpanWorksheet()">üíæ SIMPAN KE DATABASE</button>', '')}
                </div>
                <script>
                    window.onload = function() { window.print(); }
                <\/script>
            </body>
        </html>
    `);
    printWindow.document.close();
};

// ===================== TAB BUTTON INIT =====================
// Sembunyikan tombol simpan di print preview
</script>

<!-- Apps Script Code untuk Google Sheet (sertakan di README) -->
</body>
</html>
